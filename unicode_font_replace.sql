-- VERSION 0.1

CREATE OR REPLACE FUNCTION unicode_font_replace(str TEXT) RETURNS TEXT AS $$
  DECLARE
    fontbook JSONB = E'{"ð”ž":"a","ð”Ÿ":"b","ð” ":"c","ð”¡":"d","ð”¢":"e","ð”£":"f","ð”¤":"g","ð”¥":"h","ð”¦":"i","ð”§":"j","ð”¨":"k","ð”©":"l","ð”ª":"m","ð”«":"n","ð”¬":"o","ð”­":"p","ð”®":"q","ð”¯":"r","ð”°":"s","ð”±":"t","ð”²":"u","ð”³":"v","ð”´":"w","ð”µ":"x","ð”¶":"y","ð”·":"z","ð”„":"A","ð”…":"B","â„­":"C","ð”‡":"D","ð”ˆ":"E","ð”‰":"F","ð”Š":"G","â„Œ":"H","â„‘":"I","ð”":"J","ð”Ž":"K","ð”":"L","ð”":"M","ð”‘":"N","ð”’":"O","ð”“":"P","ð””":"Q","â„œ":"R","ð”–":"S","ð”—":"T","ð”˜":"U","ð”™":"V","ð”š":"W","ð”›":"X","ð”œ":"Y","â„¨":"Z","ð’‚":"a","ð’ƒ":"b","ð’„":"c","ð’…":"d","ð’†":"e","ð’‡":"f","ð’ˆ":"g","ð’‰":"h","ð’Š":"i","ð’‹":"j","ð’Œ":"k","ð’":"l","ð’Ž":"m","ð’":"n","ð’":"o","ð’‘":"p","ð’’":"q","ð’“":"r","ð’”":"s","ð’•":"t","ð’–":"u","ð’—":"v","ð’˜":"w","ð’™":"x","ð’š":"y","ð’›":"z","ð‘¨":"A","ð‘©":"B","ð‘ª":"C","ð‘«":"D","ð‘¬":"E","ð‘­":"F","ð‘®":"G","ð‘¯":"H","ð‘°":"I","ð‘±":"J","ð‘²":"K","ð‘³":"L","ð‘´":"M","ð‘µ":"N","ð‘¶":"O","ð‘·":"P","ð‘¸":"Q","ð‘¹":"R","ð‘º":"S","ð‘»":"T","ð‘¼":"U","ð‘½":"V","ð‘¾":"W","ð‘¿":"X","ð’€":"Y","ð’":"Z","ð‘Ž":"a","ð‘":"b","ð‘":"c","ð‘‘":"d","ð‘’":"e","ð‘“":"f","ð‘”":"g","â„Ž":"h","ð‘–":"i","ð‘—":"j","ð‘˜":"k","ð‘™":"l","ð‘š":"m","ð‘›":"n","ð‘œ":"o","ð‘":"p","ð‘ž":"q","ð‘Ÿ":"r","ð‘ ":"s","ð‘¡":"t","ð‘¢":"u","ð‘£":"v","ð‘¤":"w","ð‘¥":"x","ð‘¦":"y","ð‘§":"z","ð´":"A","ðµ":"B","ð¶":"C","ð·":"D","ð¸":"E","ð¹":"F","ðº":"G","ð»":"H","ð¼":"I","ð½":"J","ð¾":"K","ð¿":"L","ð‘€":"M","ð‘":"N","ð‘‚":"O","ð‘ƒ":"P","ð‘„":"Q","ð‘…":"R","ð‘†":"S","ð‘‡":"T","ð‘ˆ":"U","ð‘‰":"V","ð‘Š":"W","ð‘‹":"X","ð‘Œ":"Y","ð‘":"Z","ï½":"a","ï½‚":"b","ï½ƒ":"c","ï½„":"d","ï½…":"e","ï½†":"f","ï½‡":"g","ï½ˆ":"h","ï½‰":"i","ï½Š":"j","ï½‹":"k","ï½Œ":"l","ï½":"m","ï½Ž":"n","ï½":"o","ï½":"p","ï½‘":"q","ï½’":"r","ï½“":"s","ï½”":"t","ï½•":"u","ï½–":"v","ï½—":"w","ï½˜":"x","ï½™":"y","ï½š":"z","ï¼¡":"A","ï¼¢":"B","ï¼£":"C","ï¼¤":"D","ï¼¥":"E","ï¼¦":"F","ï¼§":"G","ï¼¨":"H","ï¼©":"I","ï¼ª":"J","ï¼«":"K","ï¼¬":"L","ï¼­":"M","ï¼®":"N","ï¼¯":"O","ï¼°":"P","ï¼±":"Q","ï¼²":"R","ï¼³":"S","ï¼´":"T","ï¼µ":"U","ï¼¶":"V","ï¼·":"W","ï¼¸":"X","ï¼¹":"Y","ï¼º":"Z","ï¼":"0","ï¼‘":"1","ï¼’":"2","ï¼“":"3","ï¼”":"4","ï¼•":"5","ï¼–":"6","ï¼—":"7","ï¼˜":"8","ï¼™":"9","á´€":"a","Ê™":"b","á´„":"c","á´…":"d","á´‡":"e","êœ°":"f","É¢":"g","Êœ":"h","Éª":"i","á´Š":"j","á´‹":"k","ÊŸ":"l","á´":"m","É´":"n","á´":"o","á´˜":"p","Ê€":"r","êœ±":"s","á´›":"t","á´œ":"u","á´ ":"v","á´¡":"w","Ê":"y","á´¢":"z","ï¹—":"!","ï¹–":"?","ï¹’":".","ï¹":",","ð’¶":"a","ð’·":"b","ð’¸":"c","ð’¹":"d","â„¯":"e","ð’»":"f","â„Š":"g","ð’½":"h","ð’¾":"i","ð’¿":"j","ð“€":"k","ð“":"l","ð“‚":"m","ð“ƒ":"n","â„´":"o","ð“…":"p","ð“†":"q","ð“‡":"r","ð“ˆ":"s","ð“‰":"t","ð“Š":"u","ð“‹":"v","ð“Œ":"w","ð“":"x","ð“Ž":"y","ð“":"z","ð’œ":"A","â„¬":"B","ð’ž":"C","ð’Ÿ":"D","â„°":"E","â„±":"F","ð’¢":"G","â„‹":"H","â„":"I","ð’¥":"J","ð’¦":"K","â„’":"L","â„³":"M","ð’©":"N","ð’ª":"O","ð’«":"P","ð’¬":"Q","â„›":"R","ð’®":"S","ð’¯":"T","ð’°":"U","ð’±":"V","ð’²":"W","ð’³":"X","ð’´":"Y","ð’µ":"Z","ð“ª":"a","ð“«":"b","ð“¬":"c","ð“­":"d","ð“®":"e","ð“¯":"f","ð“°":"g","ð“±":"h","ð“²":"i","ð“³":"j","ð“´":"k","ð“µ":"l","ð“¶":"m","ð“·":"n","ð“¸":"o","ð“¹":"p","ð“º":"q","ð“»":"r","ð“¼":"s","ð“½":"t","ð“¾":"u","ð“¿":"v","ð”€":"w","ð”":"x","ð”‚":"y","ð”ƒ":"z","ð“":"A","ð“‘":"B","ð“’":"C","ð““":"D","ð“”":"E","ð“•":"F","ð“–":"G","ð“—":"H","ð“˜":"I","ð“™":"J","ð“š":"K","ð“›":"L","ð“œ":"M","ð“":"N","ð“ž":"O","ð“Ÿ":"P","ð“ ":"Q","ð“¡":"R","ð“¢":"S","ð“£":"T","ð“¤":"U","ð“¥":"V","ð“¦":"W","ð“§":"X","ð“¨":"Y","ð“©":"Z","â—":"!","â“":"?","â•":"!","â”":"?","ð–†":"a","ð–‡":"b","ð–ˆ":"c","ð–‰":"d","ð–Š":"e","ð–‹":"f","ð–Œ":"g","ð–":"h","ð–Ž":"i","ð–":"j","ð–":"k","ð–‘":"l","ð–’":"m","ð–“":"n","ð–”":"o","ð–•":"p","ð––":"q","ð–—":"r","ð–˜":"s","ð–™":"t","ð–š":"u","ð–›":"v","ð–œ":"w","ð–":"x","ð–ž":"y","ð–Ÿ":"z","ð•¬":"A","ð•­":"B","ð•®":"C","ð•¯":"D","ð•°":"E","ð•±":"F","ð•²":"G","ð•³":"H","ð•´":"I","ð•µ":"J","ð•¶":"K","ð•·":"L","ð•¸":"M","ð•¹":"N","ð•º":"O","ð•»":"P","ð•¼":"Q","ð•½":"R","ð•¾":"S","ð•¿":"T","ð–€":"U","ð–":"V","ð–‚":"W","ð–ƒ":"X","ð–„":"Y","ð–…":"Z","ðšŠ":"a","ðš‹":"b","ðšŒ":"c","ðš":"d","ðšŽ":"e","ðš":"f","ðš":"g","ðš‘":"h","ðš’":"i","ðš“":"j","ðš”":"k","ðš•":"l","ðš–":"m","ðš—":"n","ðš˜":"o","ðš™":"p","ðšš":"q","ðš›":"r","ðšœ":"s","ðš":"t","ðšž":"u","ðšŸ":"v","ðš ":"w","ðš¡":"x","ðš¢":"y","ðš£":"z","ð™°":"A","ð™±":"B","ð™²":"C","ð™³":"D","ð™´":"E","ð™µ":"F","ð™¶":"G","ð™·":"H","ð™¸":"I","ð™¹":"J","ð™º":"K","ð™»":"L","ð™¼":"M","ð™½":"N","ð™¾":"O","ð™¿":"P","ðš€":"Q","ðš":"R","ðš‚":"S","ðšƒ":"T","ðš„":"U","ðš…":"V","ðš†":"W","ðš‡":"X","ðšˆ":"Y","ðš‰":"Z","ðŸ¶":"0","ðŸ·":"1","ðŸ¸":"2","ðŸ¹":"3","ðŸº":"4","ðŸ»":"5","ðŸ¼":"6","ðŸ½":"7","ðŸ¾":"8","ðŸ¿":"9","ï¼":"!","ï¼Ÿ":"?","ï¼Ž":".","ï¼Œ":",","ðš":"a","ð›":"b","ðœ":"c","ð":"d","ðž":"e","ðŸ":"f","ð ":"g","ð¡":"h","ð¢":"i","ð£":"j","ð¤":"k","ð¥":"l","ð¦":"m","ð§":"n","ð¨":"o","ð©":"p","ðª":"q","ð«":"r","ð¬":"s","ð­":"t","ð®":"u","ð¯":"v","ð°":"w","ð±":"x","ð²":"y","ð³":"z","ð€":"A","ð":"B","ð‚":"C","ðƒ":"D","ð„":"E","ð…":"F","ð†":"G","ð‡":"H","ðˆ":"I","ð‰":"J","ðŠ":"K","ð‹":"L","ðŒ":"M","ð":"N","ðŽ":"O","ð":"P","ð":"Q","ð‘":"R","ð’":"S","ð“":"T","ð”":"U","ð•":"V","ð–":"W","ð—":"X","ð˜":"Y","ð™":"Z","ðŸŽ":"0","ðŸ":"1","ðŸ":"2","ðŸ‘":"3","ðŸ’":"4","ðŸ“":"5","ðŸ”":"6","ðŸ•":"7","ðŸ–":"8","ðŸ—":"9","ð–º":"a","ð–»":"b","ð–¼":"c","ð–½":"d","ð–¾":"e","ð–¿":"f","ð—€":"g","ð—":"h","ð—‚":"i","ð—ƒ":"j","ð—„":"k","ð—…":"l","ð—†":"m","ð—‡":"n","ð—ˆ":"o","ð—‰":"p","ð—Š":"q","ð—‹":"r","ð—Œ":"s","ð—":"t","ð—Ž":"u","ð—":"v","ð—":"w","ð—‘":"x","ð—’":"y","ð—“":"z","ð– ":"A","ð–¡":"B","ð–¢":"C","ð–£":"D","ð–¤":"E","ð–¥":"F","ð–¦":"G","ð–§":"H","ð–¨":"I","ð–©":"J","ð–ª":"K","ð–«":"L","ð–¬":"M","ð–­":"N","ð–®":"O","ð–¯":"P","ð–°":"Q","ð–±":"R","ð–²":"S","ð–³":"T","ð–´":"U","ð–µ":"V","ð–¶":"W","ð–·":"X","ð–¸":"Y","ð–¹":"Z","ðŸ¢":"0","ðŸ£":"1","ðŸ¤":"2","ðŸ¥":"3","ðŸ¦":"4","ðŸ§":"5","ðŸ¨":"6","ðŸ©":"7","ðŸª":"8","ðŸ«":"9","ð—®":"a","ð—¯":"b","ð—°":"c","ð—±":"d","ð—²":"e","ð—³":"f","ð—´":"g","ð—µ":"h","ð—¶":"i","ð—·":"j","ð—¸":"k","ð—¹":"l","ð—º":"m","ð—»":"n","ð—¼":"o","ð—½":"p","ð—¾":"q","ð—¿":"r","ð˜€":"s","ð˜":"t","ð˜‚":"u","ð˜ƒ":"v","ð˜„":"w","ð˜…":"x","ð˜†":"y","ð˜‡":"z","ð—”":"A","ð—•":"B","ð—–":"C","ð——":"D","ð—˜":"E","ð—™":"F","ð—š":"G","ð—›":"H","ð—œ":"I","ð—":"J","ð—ž":"K","ð—Ÿ":"L","ð— ":"M","ð—¡":"N","ð—¢":"O","ð—£":"P","ð—¤":"Q","ð—¥":"R","ð—¦":"S","ð—§":"T","ð—¨":"U","ð—©":"V","ð—ª":"W","ð—«":"X","ð—¬":"Y","ð—­":"Z","ðŸ¬":"0","ðŸ­":"1","ðŸ®":"2","ðŸ¯":"3","ðŸ°":"4","ðŸ±":"5","ðŸ²":"6","ðŸ³":"7","ðŸ´":"8","ðŸµ":"9","ð™–":"a","ð™—":"b","ð™˜":"c","ð™™":"d","ð™š":"e","ð™›":"f","ð™œ":"g","ð™":"h","ð™ž":"i","ð™Ÿ":"j","ð™ ":"k","ð™¡":"l","ð™¢":"m","ð™£":"n","ð™¤":"o","ð™¥":"p","ð™¦":"q","ð™§":"r","ð™¨":"s","ð™©":"t","ð™ª":"u","ð™«":"v","ð™¬":"w","ð™­":"x","ð™®":"y","ð™¯":"z","ð˜¼":"A","ð˜½":"B","ð˜¾":"C","ð˜¿":"D","ð™€":"E","ð™":"F","ð™‚":"G","ð™ƒ":"H","ð™„":"I","ð™…":"J","ð™†":"K","ð™‡":"L","ð™ˆ":"M","ð™‰":"N","ð™Š":"O","ð™‹":"P","ð™Œ":"Q","ð™":"R","ð™Ž":"S","ð™":"T","ð™":"U","ð™‘":"V","ð™’":"W","ð™“":"X","ð™”":"Y","ð™•":"Z","ð˜¢":"a","ð˜£":"b","ð˜¤":"c","ð˜¥":"d","ð˜¦":"e","ð˜§":"f","ð˜¨":"g","ð˜©":"h","ð˜ª":"i","ð˜«":"j","ð˜¬":"k","ð˜­":"l","ð˜®":"m","ð˜¯":"n","ð˜°":"o","ð˜±":"p","ð˜²":"q","ð˜³":"r","ð˜´":"s","ð˜µ":"t","ð˜¶":"u","ð˜·":"v","ð˜¸":"w","ð˜¹":"x","ð˜º":"y","ð˜»":"z","ð˜ˆ":"A","ð˜‰":"B","ð˜Š":"C","ð˜‹":"D","ð˜Œ":"E","ð˜":"F","ð˜Ž":"G","ð˜":"H","ð˜":"I","ð˜‘":"J","ð˜’":"K","ð˜“":"L","ð˜”":"M","ð˜•":"N","ð˜–":"O","ð˜—":"P","ð˜˜":"Q","ð˜™":"R","ð˜š":"S","ð˜›":"T","ð˜œ":"U","ð˜":"V","ð˜ž":"W","ð˜Ÿ":"X","ð˜ ":"Y","ð˜¡":"Z","â“":"a","â“‘":"b","â“’":"c","â““":"d","â“”":"e","â“•":"f","â“–":"g","â“—":"h","â“˜":"i","â“™":"j","â“š":"k","â“›":"l","â“œ":"m","â“":"n","â“ž":"o","â“Ÿ":"p","â“ ":"q","â“¡":"r","â“¢":"s","â“£":"t","â“¤":"u","â“¥":"v","â“¦":"w","â“§":"x","â“¨":"y","â“©":"z","â’¶":"A","â’·":"B","â’¸":"C","â’¹":"D","â’º":"E","â’»":"F","â’¼":"G","â’½":"H","â’¾":"I","â’¿":"J","â“€":"K","â“":"L","â“‚":"M","â“ƒ":"N","â“„":"O","â“…":"P","â“†":"Q","â“‡":"R","â“ˆ":"S","â“‰":"T","â“Š":"U","â“‹":"V","â“Œ":"W","â“":"X","â“Ž":"Y","â“":"Z","â“ª":"0","â‘ ":"1","â‘¡":"2","â‘¢":"3","â‘£":"4","â‘¤":"5","â‘¥":"6","â‘¦":"7","â‘§":"8","â‘¨":"9","â’œ":"a","â’":"b","â’ž":"c","â’Ÿ":"d","â’ ":"e","â’¡":"f","â’¢":"g","â’£":"h","â’¤":"i","â’¥":"j","â’¦":"k","â’§":"l","â’¨":"m","â’©":"n","â’ª":"o","â’«":"p","â’¬":"q","â’­":"r","â’®":"s","â’¯":"t","â’°":"u","â’±":"v","â’²":"w","â’³":"x","â’´":"y","â’µ":"z","ðŸ„":"A","ðŸ„‘":"B","ðŸ„’":"C","ðŸ„“":"D","ðŸ„”":"E","ðŸ„•":"F","ðŸ„–":"G","ðŸ„—":"H","ðŸ„˜":"I","ðŸ„™":"J","ðŸ„š":"K","ðŸ„›":"L","ðŸ„œ":"M","ðŸ„":"N","ðŸ„ž":"O","ðŸ„Ÿ":"P","ðŸ„ ":"Q","ðŸ„¡":"R","ðŸ„¢":"S","ðŸ„£":"T","ðŸ„¤":"U","ðŸ„¥":"V","ðŸ„¦":"W","ðŸ„§":"X","ðŸ„¨":"Y","ðŸ„©":"Z","â“¿":"0","â‘´":"1","â‘µ":"2","â‘¶":"3","â‘·":"4","â‘¸":"5","â‘¹":"6","â‘º":"7","â‘»":"8","â‘¼":"9","ð•’":"a","ð•“":"b","ð•”":"c","ð••":"d","ð•–":"e","ð•—":"f","ð•˜":"g","ð•™":"h","ð•š":"i","ð•›":"j","ð•œ":"k","ð•":"l","ð•ž":"m","ð•Ÿ":"n","ð• ":"o","ð•¡":"p","ð•¢":"q","ð•£":"r","ð•¤":"s","ð•¥":"t","ð•¦":"u","ð•§":"v","ð•¨":"w","ð•©":"x","ð•ª":"y","ð•«":"z","ð”¸":"A","ð”¹":"B","â„‚":"C","ð”»":"D","ð”¼":"E","ð”½":"F","ð”¾":"G","â„":"H","ð•€":"I","ð•":"J","ð•‚":"K","ð•ƒ":"L","ð•„":"M","â„•":"N","ð•†":"O","â„™":"P","â„š":"Q","â„":"R","ð•Š":"S","ð•‹":"T","ð•Œ":"U","ð•":"V","ð•Ž":"W","ð•":"X","ð•":"Y","â„¤":"Z","ðŸ˜":"0","ðŸ™":"1","ðŸš":"2","ðŸ›":"3","ðŸœ":"4","ðŸ":"5","ðŸž":"6","ðŸŸ":"7","ðŸ ":"8","ðŸ¡":"9","ðŸ„°":"a","ðŸ„±":"b","ðŸ„²":"c","ðŸ„³":"d","ðŸ„´":"e","ðŸ„µ":"f","ðŸ„¶":"g","ðŸ„·":"h","ðŸ„¸":"i","ðŸ„¹":"j","ðŸ„º":"k","ðŸ„»":"l","ðŸ„¼":"m","ðŸ„½":"n","ðŸ„¾":"o","ðŸ„¿":"p","ðŸ…€":"q","ðŸ…":"r","ðŸ…‚":"s","ðŸ…ƒ":"t","ðŸ…„":"u","ðŸ……":"v","ðŸ…†":"w","ðŸ…‡":"x","ðŸ…ˆ":"y","ðŸ…‰":"z","ðŸ…°":"a","ðŸ…±":"b","ðŸ…²":"c","ðŸ…³":"d","ðŸ…´":"e","ðŸ…µ":"f","ðŸ…¶":"g","ðŸ…·":"h","ðŸ…¸":"i","ðŸ…¹":"j","ðŸ…º":"k","ðŸ…»":"l","ðŸ…¼":"m","ðŸ…½":"n","ðŸ…¾":"o","ðŸ…¿":"p","ðŸ†€":"q","ðŸ†":"r","ðŸ†‚":"s","ðŸ†ƒ":"t","ðŸ†„":"u","ðŸ†…":"v","ðŸ††":"w","ðŸ†‡":"x","ðŸ†ˆ":"y","ðŸ†‰":"z","á—©":"a","á—·":"b","á‘•":"c","á—ª":"d","á–´":"f","á•¼":"h","á’":"j","á’ª":"l","á—°":"m","á‘Ž":"n","á‘­":"p","á‘«":"q","á–‡":"r","á”•":"s","á‘Œ":"u","á¯":"v","á—¯":"w","á™­":"x","á˜”":"z","áµƒ":"a","áµ‡":"b","á¶œ":"c","áµˆ":"d","áµ‰":"e","á¶ ":"f","áµ":"g","Ê°":"h","á¶¦":"i","Ê²":"j","áµ":"k","Ë¡":"l","áµ":"m","â¿":"n","áµ’":"o","áµ–":"p","áµ ":"q","Ê³":"r","Ë¢":"s","áµ—":"t","áµ˜":"u","áµ›":"v","Ê·":"w","Ë£":"x","á¶»":"z","á´¬":"A","á´®":"B","á´°":"D","á´±":"E","á´³":"G","á´´":"H","á´µ":"I","á´¶":"J","á´·":"K","á´¸":"L","á´¹":"M","á´º":"N","á´¼":"O","á´¾":"P","áµ ":"Q","á´¿":"R","áµ€":"T","áµ":"U","â±½":"V","áµ‚":"W","á¶»":"Z"}';
    result TEXT = '';
    current VARCHAR(1);
  BEGIN
    IF str IS NULL THEN RETURN NULL; END IF;
    fontbook = fontbook || jsonb_build_object('ï¼‚','"','ï¼‡',E'\'');
    FOR i IN 1..char_length(str) LOOP
      current = substr(str, i, 1);
      result = result || coalesce(fontbook->>current, current);
    END LOOP;
    RETURN result;
  END
$$ LANGUAGE plpgsql;
